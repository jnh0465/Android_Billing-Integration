<!-- 결제완료화면에서 구매내역보기 버튼 누르면 넘어가는 리스트 화면 -->

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  </head>

  <style>
    h5{  text-align:center;}
  </style>

  <body>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
      <div><br><h5>
          <div class="container">
            <table class="table table-striped">
              <thead>
                <tr class="success">
                  <th>주문번호</th>
                  <th>날짜</th>
                  <th>메뉴</th>
                  <th>가격</th>
                </tr>
              </thead>
              <script type="text/javascript" >
                var obj_orderInfo_length = "<%= obj_orderInfo_length%>"; // 역대 주문수 / orderInfo[n]에서의 n

                var obj_length = "<%= obj_length%>";      // 주문수별 주문한 메뉴개수 / orderInfo[n].order[m]에서의 m
                var obj_length_split = obj_length.split(',');

                var list_array = "<%= list%>";             // 메뉴
                var list_split = list_array.split(',');

                var paymentNum_array = "<%= paymentNum%>"; // 결제번호
                var paymentNum_split = paymentNum_array.split(',');

                var date_array = "<%= date%>";             // 날짜+시간
                var date_split = date_array.split(',');

                var price_array = "<%= totPrice%>";        // 총금액
                var price_split = price_array.split(',');
                
                var num_menu=0, menu_tmp=[];
                for (var i=0; i<obj_orderInfo_length; i++){
                  var a= Number(obj_length_split[i]);
                  num_menu += a;
                }

                for(var i=0; i<num_menu; i++){
                  menu_tmp.push(menu_list_split[i]);
                }

                num_menu=0;
                for(i=0; i<obj_orderInfo_length; i++){
                  var a= Number(obj_length_split[i]);   // 메뉴의 개수를 a에 저장하고
                  num_menu += a;                        // num_menu에 계속 쌓음
                  //document.write(a+" ");              // 1 1 1 1 1 1 2 1 2 (메뉴의 개수)
                  //document.write(num_menu+" ");       // 1 2 3 4 5 6 8 9 11 (11개의 메뉴가 있음을 알 수 있음)
                                                        // 바꿔생각해보면 [num_menu-1]번째(배열은 0부터 시작하니 -1해주기)의 메뉴들만 나열하면 제일 상위의 메뉴임을 알 수 있음

                  document.write("<tr>");
                  document.write("<td>"+paymentNum_split[i]+"</td>");
                  document.write("<td>"+date_split[i]+"</td>");

                  if(a==1){
                    document.write("<td>"+menu_tmp[num_menu-1]+"</td>");   //외 0건이라고 나오면 이상하니 주문이 1건만 있을 때는 그냥 메뉴이름만 넣자
                  }
                  else{
                    document.write("<td>"+menu_tmp[num_menu-1]+" 외 "+(a-1)+"건"+"</td>");
                  } // 각각의 주문별 제일 상위의 메뉴만 표시하고 [ㅇㅇ 외 1건 ] 로 명시

                  document.write("<td>"+price_split[i]+"</td>");
                  document.write("</tr>");
                }

              </script>
            </table>
          </div>
        </h5>
  </body>
</html>
